---
output: 
  revealjs.jg::revealjs_presentation:
    controls: true
---
```{r initialize, cache=FALSE, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
message("now at 1")
knitr::opts_chunk$set(cache=FALSE,echo=FALSE)
message("now at 2")
```
```{r load_semester_info, cache=FALSE, echo=FALSE, message=FALSE, warning=FALSE, results="hide"}
message("now at 3")
library(yaml)
library(stringr)
message("now at 4")
site = yaml.load_file("semester.yml")
message("now at 5")

semester.dir <- '.'
script.dir <- file.path(semester.dir,'util_scripts')
data.dir <- file.path(semester.dir, 'data')
message("now at 6")

source_semester_script <- function(script) {
  script_file <- file.path(script.dir, script)
  source(script_file, chdir = TRUE)
}
message("now at 7")

source_semester_script('rmd_header.R')
message("now at 8")

```

## `r site$course`:<br/>`r site$course_name` {#navigation .seventy}

### Navigation:

<ul style="width:95%;">
<li><a href="`r file.path(semester.dir, 'assets', 'pdf', 'EES_3310_5310_Syllabus.pdf')`"><b>Syllabus</b></a>
<li><a href="`r file.path(semester.dir, 'assets', 'pdf', 'EES_3310_5310_Reading_Assignments.pdf')`"><b>Reading Assignments</b></a>
<li><b>Classes:</b></li>
<ul style="height:600px; width:95%; overflow-x:hidden; overflow-y:scroll; white-space:normal;">

```{r link_to_lectures, echo = FALSE, results = 'asis', cache=FALSE}
files = dir('Slides', 'index.Rmd', recursive = TRUE, full = TRUE)
links <- c()

last_lecture_file <- 'last_class.yml'
if (file.exists(last_lecture_file)) {
  last_lecture <- yaml.load_file(last_lecture_file)$last_lecture
} else last_lecture <- NA
for (f in files) {
  url = NULL
  htmlfile <- sub('\\.Rmd$','.html',f)
    metadata <- grab_header(f)
    num <- metadata$class_no
    title <- metadata$title
    class_date <- metadata$class_date
  if (file.exists(htmlfile)) {
    url <- URLencode(htmlfile)
  } else {
    dir = dirname(f)
    pdf_file = file.path(dir, sprintf("EES_3310_5310_Class_%02d.pdf", num))
    if (file.exists(pdf_file)) {
      url <- URLencode(pdf_file)
    }
  }
    if (! is.null(url) && (is.na(last_lecture) || num <= last_lecture)) {
      links = c(links, 
                paste0('<li><a href="', url, '">Class #', num , '</a> (', 
                       strip_year(class_date), '): "', 
                       gsub('<br */>',' ', title, ignore.case = TRUE), '"</li>'))
    }
}
writeLines(links)
```
</ul>
&nbsp;<br/>
</li>
</ul>
&nbsp;<br/>
